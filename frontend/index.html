<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>私有云图床工具</title>
    <link rel="stylesheet" href="/static/style.css?v=1.1">
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>私有云图床</h1>
            <p class="subtitle">永久存储 · 批量处理</p>
            <div class="header-tools">
                <button class="btn-ghost" id="themeToggle">🌙 深色模式</button>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" id="tab-upload">批量上传</button>
            <button class="tab" id="tab-paste">粘贴上传</button>
            <button class="tab" id="tab-history">历史记录</button>
        </div>

        <!-- 1. 批量上传页 -->
        <div id="content-upload" class="tab-content active">
            <div id="uploadArea" class="upload-area">
                <p>点击或拖拽多张图片到这里</p>
            </div>

            <input type="file" id="fileInput" accept="image/*" multiple hidden>

            <!-- 上传列表的多选工具栏 -->
            <div class="multi-select-toolbar" id="uploadMultiToolbar" style="display:none; margin-bottom:10px;">
                <label style="font-size:14px; display:flex; align-items:center; cursor:pointer;">
                    <input type="checkbox" id="uploadSelectAll"
                        style="width:16px; height:16px; margin-right:8px; accent-color:var(--primary-color);">
                    全选
                </label>
                <div class="multi-actions" style="display:flex; gap:10px; align-items:center;">
                    <span style="font-size:13px; color:var(--text-secondary);">已选 <b
                            id="uploadSelectedCount">0</b></span>
                    <button class="btn-mini" id="uploadBatchGenBtn">生成json文件</button>
                    <button class="btn-mini" id="uploadBatchDelBtn"
                        style="color:var(--danger); border-color:var(--danger);">移除</button>
                </div>
            </div>

            <!-- 批量列表区域 -->
            <div id="uploadBatchList" class="batch-list"></div>
        </div>

        <!-- 2. 粘贴上传页 -->
        <div id="content-paste" class="tab-content">
            <div id="pasteArea" class="paste-area" tabindex="0">
                <p>Ctrl + V 在此处粘贴图片</p>
            </div>
            <img id="pastePreview" class="preview-img">
            <div id="pasteLoading" class="loading" style="display:none;">
                <div class="spinner"></div>
                <p>处理中...</p>
            </div>

            <div id="pasteResult" class="result-box">
                <h3>上传成功</h3>
                <span id="pasteServiceBadge" class="service-badge"></span>
                <div class="url-box"><a id="pasteResultUrl" target="_blank"></a></div>
                <div class="action-buttons">
                    <button class="copy-btn" id="pasteCopyBtn">复制</button>
                    <button class="copy-btn" id="pasteOpenBtn">打开</button>
                </div>
                <div class="rename-box" style="margin-top:10px; display:flex; gap:8px; align-items:center;">
                    <span>图片名称:</span>
                    <input type="text" id="pasteFilenameInput" class="input-text" style="flex:1;">
                    <button class="btn-mini" id="pasteRenameSaveBtn">保存名称</button>
                </div>
            </div>
        </div>

        <!-- 3. 历史记录页 -->
        <div id="content-history" class="tab-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                <h3>历史记录</h3>
                <div class="history-tools">
                    <button class="btn-ghost" id="clearHistoryBtn" style="color:var(--danger)">清空全部</button>
                </div>
            </div>

            <!-- 搜索栏 -->
            <div style="margin-bottom: 1rem;">
                <div style="position: relative; max-width: 400px;">
                    <input type="text" id="historySearch" placeholder="🔍 搜索文件名或URL..." class="input-text"
                        style="width: 100%; padding: 10px 40px 10px 15px; font-size: 14px; border-radius: 8px; border: 1px solid var(--border-color); transition: all 0.2s;">
                    <button id="historySearchBtn"
                        style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: var(--primary-color); color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-size: 13px; transition: all 0.2s;">
                        搜索
                    </button>
                </div>
            </div>

            <!-- 历史多选工具栏 -->
            <div class="multi-select-toolbar">
                <label style="font-size:14px; display:flex; align-items:center; cursor:pointer;">
                    <input type="checkbox" id="selectAllCheckbox"
                        style="width:16px; height:16px; margin-right:8px; accent-color:var(--primary-color);">
                    全选 / 反选
                </label>
                <div class="multi-actions" id="multiActions" style="display:none;">
                    <span style="font-size:13px; color:var(--text-secondary); margin-right:10px;">已选 <b
                            id="selectedCount">0</b> 项</span>
                    <button class="btn-mini" id="batchGenerateDescBtn">生成json文件</button>
                    <button class="btn-mini" id="batchDeleteBtn"
                        style="color:var(--danger); border-color:var(--danger);">删除</button>
                </div>
            </div>

            <div id="historyList"></div>

            <div id="historyPagination" class="pagination-bar"
                style="display:none; margin-top:15px; padding:10px; background:var(--bg-color); border:1px solid var(--border-color); border-radius:8px; justify-content:space-between; align-items:center;">
                <div>
                    <span style="font-size:13px; color:var(--text-secondary);">每页显示:</span>
                    <select id="historyPageSizeSelect" onchange="window.changeHistoryPageSize(this.value)">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                    </select>
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="btn-mini" onclick="window.prevHistoryPage()">上一页</button>
                    <span id="historyPageInfo" style="font-size:13px; font-weight:bold;">1/1</span>
                    <button class="btn-mini" onclick="window.nextHistoryPage()">下一页</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 结果文本生成模态框 -->
    <div id="descModal" class="modal-backdrop">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">生成的JSON文件</span>
                <button class="modal-close"
                    onclick="document.getElementById('descModal').style.display='none'">×</button>
            </div>
            <div class="modal-body">
                <textarea id="descTextarea" readonly></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn-mini" id="copyDescBtn">复制文本</button>
                <button class="btn-mini" id="downloadDescBtn">生成文件</button>
            </div>
        </div>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <script src="/static/js/ui.js?v=1.1" defer></script>
    <script src="/static/js/core.js?v=1.1" defer></script>
    <script src="/static/js/upload.js?v=1.1" defer></script>
    <script src="/static/js/paste.js?v=1.1" defer></script>
    <script src="/static/js/history.js?v=1.1" defer></script>
</body>

</html>