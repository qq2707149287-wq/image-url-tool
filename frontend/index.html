<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>私有云图床工具</title>
    <!-- SVG Favicon (Blue Cloud) -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%232563eb' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M17.5 19c0-3.037-2.463-5.5-5.5-5.5S6.5 15.963 6.5 19'/%3E%3Cpath d='M20.614 16.948A4.997 4.997 0 0 0 21 16c0-2.761-2.239-5-5-5a4.997 4.997 0 0 0-3 .997A4.997 4.997 0 0 0 10 11a5 5 0 0 0-5 5c0 .356.042.703.116 1.037'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="/static/style.css?v=1.9">
    <link rel="stylesheet" href="/static/premium.css?v=1.9">
</head>

<body>
    <div class="container">
        <!-- 广告位：顶部 -->
        <div id="ad-top" class="ad-placeholder" style="display:none;"></div>

        <div class="header">
            <div class="header-brand">
                <div class="brand-logo-text" style="display:flex;align-items:center;gap:10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="text-primary" style="color: #2563eb;">
                        <path d="M17.5 19c0-3.037-2.463-5.5-5.5-5.5S6.5 15.963 6.5 19" />
                        <path
                            d="M20.614 16.948A4.997 4.997 0 0 0 21 16c0-2.761-2.239-5-5-5a4.997 4.997 0 0 0-3 .997A4.997 4.997 0 0 0 10 11a5 5 0 0 0-5 5c0 .356.042.703.116 1.037" />
                    </svg>
                    私有云图床
                </div>
                <p class="subtitle">永久存储 · 极致体验 · 批量管理</p>
            </div>

            <div class="header-tools">
                <button class="btn-ghost" id="themeToggle" title="切换深色模式"
                    style="display:flex;align-items:center;justify-content:center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
                    </svg>
                </button>
                <button class="btn-vip" id="upgradeVipBtn" style="display:flex;align-items:center;gap:6px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 3h12l4 6-10 13L2 9Z" />
                        <path d="M11 3 8 9l4 13 4-13-3-6" />
                        <path d="M2 9h20" />
                    </svg>
                    升级 VIP
                </button>

                <!-- 游客状态 -->
                <div id="guestTools" class="auth-tools">
                    <button class="btn-ghost" onclick="document.getElementById('authBtn').click()">登录</button>
                    <button class="btn-primary"
                        onclick="document.getElementById('authToggleLink').click();document.getElementById('authBtn').click()">注册</button>
                    <!-- 隐藏的原始按钮，用于兼容旧 JS -->
                    <button id="authBtn" style="display:none">登录/注册</button>
                </div>

                <!-- 登录状态 (下拉菜单) -->
                <div id="userMenuContainer" class="user-menu-container" style="display:none;">
                    <button class="user-menu-trigger" id="userMenuTrigger">
                        <img id="headerUserAvatar" src=""
                            onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                            alt="Avatar">
                        <!-- Fallback SVG Avatar -->
                        <div id="headerUserAvatarFallback"
                            style="display:none;width:34px;height:34px;border-radius:50%;background:#e2e8f0;display:flex;align-items:center;justify-content:center;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="#64748b" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                                <circle cx="12" cy="7" r="4" />
                            </svg>
                        </div>
                        <span id="headerUserName">User</span>
                        <!-- Header VIP Badge -->
                        <span id="headerVipBadge" class="vip-badge-mini" style="display:none">VIP</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="dropdown-arrow">
                            <path d="m6 9 6 6 6-6" />
                        </svg>
                    </button>

                    <div class="user-dropdown-menu" id="userDropdown">
                        <div class="dropdown-header">
                            <div class="user-info-row">
                                <strong id="dropdownUserName">User</strong>
                                <span id="dropdownVipBadge" class="vip-badge" style="display:none">VIP</span>
                            </div>
                            <small id="dropdownUserEmail" class="text-muted">user@example.com</small>
                        </div>
                        <div class="dropdown-divider"></div>

                        <a href="/admin" id="dropdownAdminLink" class="dropdown-item" style="display:none;">
                            <span>👑 管理后台</span>
                        </a>

                        <!-- New Settings -->
                        <button class="dropdown-item" onclick="window.showToast('功能开发中...', 'info')">
                            <span>📉 图片压缩: 高</span>
                        </button>
                        <button class="dropdown-item" onclick="window.showToast('功能开发中...', 'info')">
                            <span>📋 自动复制: 开</span>
                        </button>
                        <button class="dropdown-item" onclick="window.showToast('功能开发中...', 'info')">
                            <span>🌐 语言设置: 简体中文</span>
                        </button>

                        <div class="dropdown-divider"></div>

                        <button class="dropdown-item" id="dropdownSettingsBtn">
                            <span>⚙️ 账号设置</span>
                        </button>
                        <button class="dropdown-item" id="settingsBtn">
                            <span>🛠️ 系统设置</span>
                        </button>

                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item text-danger" id="dropdownLogoutBtn">
                            <span>🚪 退出登录</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" id="tab-upload">
                <span style="display:flex;align-items:center;gap:6px;justify-content:center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                        <polyline points="17 8 12 3 7 8" />
                        <line x1="12" y1="3" x2="12" y2="15" />
                    </svg>
                    上传图片
                </span>
            </button>
            <button class="tab" id="tab-history">
                <span style="display:flex;align-items:center;gap:6px;justify-content:center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 3v5h5" />
                        <path d="M3.05 13A9 9 0 1 0 6 5.3L3 8" />
                    </svg>
                    历史记录
                </span>
            </button>
        </div>

        <!-- 1. 批量上传页 -->
        <div id="content-upload" class="tab-content active">
            <!-- 漂亮的上传区域 -->
            <div id="uploadArea" class="upload-area" tabindex="0">
                <div class="upload-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                        style="color:#60a5fa;">
                        <path d="M17.5 19c0-3.037-2.463-5.5-5.5-5.5S6.5 15.963 6.5 19" />
                        <path
                            d="M20.614 16.948A4.997 4.997 0 0 0 21 16c0-2.761-2.239-5-5-5a4.997 4.997 0 0 0-3 .997A4.997 4.997 0 0 0 10 11a5 5 0 0 0-5 5c0 .356.042.703.116 1.037" />
                    </svg>
                </div>
                <h3>点击或拖拽图片到这里</h3>
                <p class="upload-hint">支持 Ctrl+V 粘贴 · 单文件最大 10MB</p>

                <!-- 嵌入式上传模式切换 -->
                <div class="upload-mode-segmented">
                    <button type="button" class="segment-btn active" data-mode="private"
                        onclick="toggleUploadMode('private', event)"
                        style="display:inline-flex;align-items:center;gap:4px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                        </svg>
                        私有存储</button>
                    <button type="button" class="segment-btn" data-mode="public"
                        onclick="toggleUploadMode('public', event)"
                        style="display:inline-flex;align-items:center;gap:4px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10" />
                            <line x1="2" y1="12" x2="22" y2="12" />
                            <path
                                d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
                        </svg>
                        公开共享</button>
                    <!-- 隐藏的原始 Toggle 按钮 -->
                    <button type="button" id="uploadModeBtn" class="mode-toggle-btn" style="display:none;"></button>
                </div>
            </div>

            <input type="file" id="fileInput" accept="image/*" multiple hidden>

            <!-- 批量操作工具栏 -->
            <div class="multi-select-toolbar" id="uploadMultiToolbar" style="display:none; animation: fadeIn 0.3s;">
                <label style="font-size:14px; display:flex; align-items:center; cursor:pointer;">
                    <input type="checkbox" id="uploadSelectAll"
                        style="width:16px; height:16px; margin-right:8px; accent-color:var(--primary-color);">
                    全选
                </label>
                <div class="multi-actions" style="display:flex; gap:10px; align-items:center;">
                    <span style="font-size:13px; color:var(--text-secondary);">已选 <b
                            id="uploadSelectedCount">0</b></span>
                    <button class="btn-mini" id="uploadBatchGenBtn">生成json文件</button>
                    <button class="btn-mini" id="uploadBatchDelBtn"
                        style="color:var(--danger); border-color:var(--danger);">移除</button>
                </div>
            </div>

            <!-- 批量列表区域 -->
            <div id="uploadBatchList" class="batch-list"></div>
        </div>



        <!-- 2. 历史记录页 -->
        <div id="content-history" class="tab-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                <div style="display:flex; align-items:center; gap:15px;">
                    <h3>历史记录</h3>
                    <!-- 只看我的（仅在共享模式下显示） -->
                    <label id="onlyMineFilter"
                        style="display:none; align-items:center; gap:5px; font-size:13px; cursor:pointer; color:var(--text-secondary);">
                        <input type="checkbox" id="onlyMineCheckbox"
                            style="width:14px; height:14px; accent-color:var(--primary-color);">
                        <span>只看我的</span>
                    </label>
                </div>
                <div class="history-tools" style="display:flex; align-items:center; gap:15px;">
                    <!-- 查看模式切换 (Use Segmented Control Style) -->
                    <div class="history-mode-segment">
                        <button type="button" class="segment-btn active" id="viewBtnPrivate" data-mode="private"
                            style="display:inline-flex;align-items:center;gap:4px; padding: 6px 12px; font-size: 13px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                            </svg>
                            私有</button>
                        <button type="button" class="segment-btn" id="viewBtnShared" data-mode="shared"
                            style="display:inline-flex;align-items:center;gap:4px; padding: 6px 12px; font-size: 13px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10" />
                                <line x1="2" y1="12" x2="22" y2="12" />
                                <path
                                    d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
                            </svg>
                            共享</button>
                    </div>
                    <button class="btn-ghost" id="clearHistoryBtn" style="color:var(--danger)">🗑️ 清空全部</button>
                </div>
            </div>

            <!-- 搜索栏 (Refined) -->
            <div class="search-container">
                <input type="text" id="historySearch" placeholder="搜索文件名或URL..." class="search-input">
                <button id="historySearchBtn" class="search-btn-icon" title="搜索">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </button>
            </div>

            <!-- 历史多选工具栏 (Refined) -->
            <div class="history-toolbar">
                <label
                    style="font-size:14px; display:flex; align-items:center; cursor:pointer; color: var(--text-color);">
                    <input type="checkbox" id="selectAllCheckbox"
                        style="width:16px; height:16px; margin-right:8px; accent-color:var(--primary-color);">
                    <span style="font-weight: 500;">全选 / 反选</span>
                </label>
                <div class="multi-actions" id="multiActions" style="display:none; align-items: center; gap: 10px;">
                    <span style="font-size:13px; color:var(--text-secondary); margin-right:5px;">已选 <b
                            id="selectedCount" style="color: var(--primary-color);">0</b> 项</span>
                    <button class="btn-mini btn-ghost" id="batchGenerateDescBtn">📄 生成JSON</button>
                    <button class="btn-mini btn-ghost text-danger" id="batchDeleteBtn">🗑️ 删除</button>
                </div>
            </div>

            <div id="historyList"></div>

            <div id="historyPagination" class="pagination-bar"
                style="display:none; margin-top:15px; padding:10px; background:var(--bg-color); border:1px solid var(--border-color); border-radius:8px; justify-content:space-between; align-items:center;">
                <div>
                    <span style="font-size:13px; color:var(--text-secondary);">每页显示:</span>
                    <select id="historyPageSizeSelect" onchange="window.changeHistoryPageSize(this.value)">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                    </select>
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="btn-mini" onclick="window.prevHistoryPage()">上一页</button>
                    <span id="historyPageInfo" style="font-size:13px; font-weight:bold;">1/1</span>
                    <button class="btn-mini" onclick="window.nextHistoryPage()">下一页</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 结果文本生成模态框 -->
    <div id="descModal" class="modal-backdrop">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">生成的JSON文件</span>
                <button class="modal-close"
                    onclick="document.getElementById('descModal').style.display='none'">×</button>
            </div>
            <div class="modal-body">
                <textarea id="descTextarea" readonly></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn-mini" id="copyDescBtn">复制文本</button>
                <button class="btn-mini" id="downloadDescBtn">生成文件</button>
            </div>
        </div>
    </div>

    <!-- 登录/注册模态框 -->
    <div id="authModal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 350px;">
            <div class="modal-header">
                <span class="modal-title" id="authTitle">登录</span>
                <button class="modal-close"
                    onclick="document.getElementById('authModal').style.display='none'">×</button>
            </div>
            <div class="modal-body">
                <div id="authFormContainer" class="auth-form">
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label style="display:block; margin-bottom: 5px; font-size: 14px;">用户名</label>
                        <input type="text" id="authUsername" class="input-text" style="width: 100%; padding: 8px;">
                    </div>

                    <!-- 邮箱 (注册/重置) -->
                    <div class="form-group" id="emailGroup" style="display:none; margin-bottom: 15px;">
                        <label style="display:block; margin-bottom: 5px; font-size: 14px;">邮箱</label>
                        <div style="display:flex;">
                            <input type="email" id="authEmail" class="input-text" style="flex:1; padding: 8px;"
                                placeholder="example@qq.com">
                            <button id="sendCodeBtn" class="btn-secondary"
                                style="margin-left:5px; white-space:nowrap;">发送验证码</button>
                        </div>
                    </div>
                    <!-- 验证码 (注册/重置) -->
                    <div class="form-group" id="codeGroup" style="display:none; margin-bottom: 15px;">
                        <label style="display:block; margin-bottom: 5px; font-size: 14px;">邮箱验证码</label>
                        <input type="text" id="authCode" class="input-text" style="width: 100%; padding: 8px;"
                            placeholder="6位数字验证码">
                    </div>

                    <!-- 图形验证码 (注册) -->
                    <div class="form-group" id="captchaGroup" style="display:none; margin-bottom: 15px;">
                        <label style="display:block; margin-bottom: 5px; font-size: 14px;">图形验证码</label>
                        <div style="position:relative; display:flex; align-items:center; gap:10px;">
                            <img id="captchaImage" src="" alt="验证码"
                                style="height:40px; border-radius:4px; cursor:pointer; border:1px solid var(--border-color);"
                                title="点击刷新验证码">
                            <div style="position:relative; flex:1;">
                                <input type="text" id="captchaInput" class="input-text"
                                    style="width:100%; padding: 8px 40px 8px 8px;" placeholder="图中字符" maxlength="4">
                                <button type="button" id="refreshCaptchaBtn" class="btn-ghost"
                                    style="position:absolute; right:2px; top:50%; transform:translateY(-50%); padding:0; width:30px; height:30px; font-size:18px; display:flex; align-items:center; justify-content:center; border:none;"
                                    title="刷新验证码">↻</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom: 20px;">
                        <div style="display:flex; justify-content:space-between;">
                            <label style="display:block; margin-bottom: 5px; font-size: 14px;">密码</label>
                            <a href="javascript:void(0)" id="forgotPasswordLink"
                                style="font-size:12px; color:#666; display:none;">忘记密码?</a>
                        </div>
                        <input type="password" id="authPassword" class="input-text" style="width: 100%; padding: 8px;"
                            minlength="6">
                        <small id="passwordHint" style="display:none; color: gray; font-size: 12px;">推荐：密码至少6个字符</small>
                    </div>

                    <!-- 记住我 (Login Only) -->
                    <div class="form-group" id="rememberMeGroup"
                        style="margin-bottom: 15px; display: flex; align-items: center;">
                        <input type="checkbox" id="authRememberMe" checked style="width: auto; margin-right: 8px;">
                        <label for="authRememberMe" style="font-size: 14px; cursor: pointer;">记住我 (30天免登录)</label>
                    </div>
                    <button class="btn-primary" id="authSubmitBtn" style="width: 100%;">登录</button>

                    <div id="googleBtnContainer" style="margin-top: 15px; display: flex; justify-content: center;">
                    </div>

                    <div style="margin-top: 15px; text-align: center; font-size: 13px;">
                        <span id="authToggleText">还没有账号？</span>
                        <a href="javascript:void(0)" id="authToggleLink" style="color: var(--primary-color);">去注册</a>
                    </div>
                    <div id="authMessage" style="color: red; margin-top: 10px; font-size: 13px; text-align: center;">
                    </div>
                </div>

                <!-- 登录后显示的信息 -->
                <div id="authUserInfoContainer" class="auth-user-info" style="display: none; text-align: center;">

                    <!-- 管理员工具 (仅管理员可见) - 移到最顶部 -->
                    <div id="adminTools"
                        style="display:none; margin-bottom: 20px; padding: 15px; border-radius: 10px; background: linear-gradient(135deg, #ff9a9e22 0%, #fad0c422 100%); border: 2px solid #d32f2f;">
                        <span
                            style="font-weight: bold; display: block; margin-bottom: 12px; color: #d32f2f; font-size: 15px;">👮
                            管理员专区</span>
                        <a href="/admin" class="btn-primary"
                            style="display: block; width: 100%; padding: 10px; text-align: center; text-decoration: none; background: #d32f2f; color: white; border-radius: 6px; margin-bottom: 10px; font-size: 14px;">
                            🖥️ 打开管理后台
                        </a>
                        <button class="btn-secondary" id="adminAuditBtn"
                            style="width: 100%; font-size: 13px; margin-bottom: 8px; background-color: #ffebee; color: #d32f2f; border-color: #ffcdd2;">
                            👁️ 上帝视角 (全站审计)
                        </button>
                        <button class="btn-secondary" id="generateVipCodesBtn"
                            style="width: 100%; font-size: 13px; background-color: #fff3e0; color: #e65100; border-color: #ffe0b2;">
                            📥 批量生成激活码
                        </button>
                    </div>

                    <p style="font-size: 18px; margin-bottom: 10px;">欢迎, <strong id="currentUserDisplay">User</strong>
                    </p>
                    <p id="userEmailDisplay" style="color: var(--text-secondary); font-size: 13px; margin-bottom: 5px;">
                    </p>
                    <p id="userStatsDisplay"
                        style="color: var(--text-secondary); font-size: 12px; margin-bottom: 15px;"></p>

                    <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 15px;">
                        <button class="btn-secondary" id="changeUsernameBtn" style="width: 100%;">修改用户名</button>
                        <button class="btn-secondary" id="changePasswordBtn" style="width: 100%;">修改密码</button>
                        <button class="btn-secondary" id="viewSessionsBtn" style="width: 100%;">设备管理</button>


                        <button class="btn-primary" id="activateVipBtn"
                            style="width: 100%; background: linear-gradient(45deg, #FFD700, #FFA500); border: none; color: #fff;">💎
                            激活 VIP</button>
                        <button class="btn-danger" id="logoutBtn" style="width: 100%;">退出登录</button>
                        <a href="javascript:void(0)" id="deleteAccountLink"
                            style="font-size: 12px; color: #999; margin-top: 10px;">注销账号</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 设备管理模态框 -->
    <div id="sessionsModal" class="modal-backdrop" style="display: none; z-index: 2000;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <span class="modal-title">设备管理</span>
                <button class="modal-close"
                    onclick="document.getElementById('sessionsModal').style.display='none'">×</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 10px; font-size: 13px; color: #666;">
                    管理您当前登录的设备。移除设备将使其立即下线。
                </div>
                <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                    <thead>
                        <tr style="border-bottom: 2px solid #eee; text-align: left;">
                            <th style="padding: 8px;">设备</th>
                            <th style="padding: 8px;">IP 地址</th>
                            <th style="padding: 8px;">最后活跃</th>
                            <th style="padding: 8px; text-align: right;">操作</th>
                        </tr>
                    </thead>
                    <tbody id="sessionsTableBody">
                        <!-- Sessions here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    </div>

    <!-- 设置模态框 -->
    <div id="settingsModal" class="modal-backdrop" style="display: none; z-index: 2002;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <span class="modal-title">系统设置</span>
                <button class="modal-close" id="settingsModalCloseBtn">×</button>
            </div>
            <div class="modal-body">
                <!-- Dummy Options -->
                <div class="form-group"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #f1f5f9;">
                    <div>
                        <span style="font-weight: 500;">图片压缩</span>
                        <small style="color: #94a3b8; display:block;">自动压缩过大的图片</small>
                    </div>
                    <select class="form-select"
                        style="padding: 4px 8px; border-radius: 6px; border: 1px solid #e2e8f0; color: #64748b;"
                        onchange="window.showToast('设置已保存', 'success')">
                        <option>关闭</option>
                        <option selected>标准</option>
                        <option>强力</option>
                    </select>
                </div>

                <div class="form-group"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #f1f5f9;">
                    <div>
                        <span style="font-weight: 500;">自动复制链接</span>
                        <small style="color: #94a3b8; display:block;">上传成功后自动复制</small>
                    </div>
                    <label class="switch">
                        <input type="checkbox" checked onchange="window.showToast('设置已保存', 'success')">
                        <span class="slider round"></span>
                    </label>
                </div>

                <div class="form-group"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #f1f5f9;">
                    <div>
                        <span style="font-weight: 500;">语言设置</span>
                    </div>
                    <select class="form-select"
                        style="padding: 4px 8px; border-radius: 6px; border: 1px solid #e2e8f0; color: #64748b;"
                        onchange="window.showToast('Language setting saved', 'success')">
                        <option selected>简体中文</option>
                        <option>English</option>
                    </select>
                </div>

                <!-- Hidden Debug Option -->
                <div id="debugSettingsGroup" style="display: none;">
                    <div class="form-group"
                        style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; margin-top: 10px; background: #fffbeeb0; border-radius: 8px; padding-left: 10px; padding-right: 10px;">
                        <div>
                            <span style="font-weight: bold; color: #d97706;">🛠️ 调试模式</span>
                            <small style="color: #d97706; display: block;">开启后注册无需验证邮箱</small>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="debugModeToggle">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- 通用输入模态框 (Change Username/Password/Confirm) -->
    <div id="inputModal" class="modal-backdrop" style="display: none; z-index: 2001;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <span class="modal-title" id="inputModalTitle">标题</span>
                <button class="modal-close" id="inputModalCloseBtn">×</button>
            </div>
            <div class="modal-body">
                <p id="inputModalMessage" style="margin-bottom: 10px; color: #666;"></p>
                <div id="inputContainer">
                    <!-- Dynamic inputs will be inserted here -->
                </div>
                <div style="margin-top: 15px; text-align: right;">
                    <button class="btn-secondary" id="inputModalCancelBtn" style="margin-right: 10px;">取消</button>
                    <button class="btn-primary" id="inputModalSubmitBtn">确定</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 分享/获取链接模态框 (PostImages style) -->
    <div id="shareModal" class="modal-backdrop" style="display: none; z-index: 2003;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <span class="modal-title">获取链接</span>
                <button class="modal-close"
                    onclick="document.getElementById('shareModal').style.display='none'">×</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px; display: flex; align-items: center; gap: 15px;">
                    <img id="shareModalThumb" src=""
                        style="width: 80px; height: 80px; object-fit: cover; border-radius: 4px; border: 1px solid #eee;">
                    <div>
                        <div id="shareModalName" style="font-weight: bold; margin-bottom: 5px;">filename.jpg</div>
                        <div id="shareModalSize" style="font-size: 13px; color: #666;">123 KB</div>
                        <div id="shareModalVipBadge"
                            style="display:none; color: #ff9800; font-size: 12px; margin-top: 5px;">💎 VIP 专属通道已开启</div>
                    </div>
                </div>

                <!-- 链接列表 -->
                <div class="share-links-container">
                    <!-- 1. 查看链接 (所有用户) -->
                    <div class="share-row">
                        <label>查看链接 (View Link)</label>
                        <div class="input-group">
                            <input type="text" id="shareLinkView" readonly>
                            <button class="btn-secondary" onclick="copyInput('shareLinkView')">复制</button>
                        </div>
                    </div>

                    <!-- 2. HTML 代码 (所有用户) -->
                    <div class="share-row collapse-toggle" onclick="toggleCollapse('shareHtml')">
                        <label>HTML 代码 (网站嵌入) <span class="arrow">▼</span></label>
                    </div>
                    <div id="shareHtml" class="share-row collapsed-content" style="display:none">
                        <div class="input-group">
                            <input type="text" id="shareLinkHtml" readonly>
                            <button class="btn-secondary" onclick="copyInput('shareLinkHtml')">复制</button>
                        </div>
                    </div>

                    <!-- 3. Markdown (注册用户/VIP) -->
                    <div class="share-row collapse-toggle" onclick="toggleCollapse('shareMd')">
                        <label>Markdown (论坛/博客) <span class="arrow">▼</span></label>
                    </div>
                    <div id="shareMd" class="share-row collapsed-content" style="display:none">
                        <div class="input-group">
                            <input type="text" id="shareLinkMd" readonly>
                            <button class="btn-secondary" onclick="copyInput('shareLinkMd')">复制</button>
                        </div>
                        <div id="shareMdGuestTip" style="display:none; font-size:12px; color:#666; padding:5px;">
                            (游客不可用，请<a href="javascript:document.getElementById('authBtn').click()">登录</a>)
                        </div>
                    </div>

                    <!-- 4. 直链 (VIP Only) -->
                    <div class="share-row collapse-toggle" onclick="toggleCollapse('shareRaw')">
                        <label>直链 (Direct Link) <span class="vip-tag">VIP</span> <span class="arrow">▼</span></label>
                    </div>
                    <div id="shareRaw" class="share-row collapsed-content" style="display:none">
                        <div id="shareRawContainer" class="input-group" style="display:none">
                            <input type="text" id="shareLinkRaw" readonly>
                            <button class="btn-secondary" onclick="copyInput('shareLinkRaw')">复制</button>
                        </div>
                        <div id="shareRawVipTip" style="font-size:12px; color:#666; padding:5px;">
                            此功能仅限 VIP 用户 (防盗链签名保护)。<a href="javascript:void(0)"
                                onclick="document.getElementById('shareModal').style.display='none'; document.getElementById('activateVipBtn').click()">升级
                                VIP</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer Section -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="/terms" target="_blank">服务条款</a>
                <span class="divider">|</span>
                <a href="/privacy" target="_blank">隐私政策</a>
                <span class="divider">|</span>
                <a href="mailto:abuse@example.com?subject=侵权举报" target="_blank">侵权举报</a>
            </div>
            <p class="copyright">© 2025 私有云图床. All rights reserved.</p>
        </div>
    </footer>

    <div id="toast-container" class="toast-container"></div>

    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="/static/js/ui.js?v=2.4" defer></script>
    <script src="/static/js/core.js?v=2.4" defer></script>
    <script src="/static/js/upload.js?v=2.4" defer></script>
    <script src="/static/js/history.js?v=2.4" defer></script>
    <script src="/static/js/auth.js?v=2.4" defer></script>
    <!-- 🔧 拆分后的新模块 -->
    <script src="/static/js/settings.js?v=1.0" defer></script>
    <script src="/static/js/account.js?v=2.6" defer></script>
    <script src="/static/js/sessions.js?v=2.5" defer></script>
    <script src="/static/js/vip.js?v=2.2" defer></script>
</body>

</html>